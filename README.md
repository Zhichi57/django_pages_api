# API для просмотра страниц и связанными с ними контентом

## Условия

1. Была дана модель предметной области с сущностями:
	- Страница (Page)
	- Контент типа видео (Video)
		- специфичные атрибуты: ссылка на видеофайл, ссылка на файл субтитров

	- Контент типа аудио (Audio)
		- специфичные атрибуты: битрейт в количестве бит в секунду

	- Контент типа текст (Text)
		- специфичные атрибуты: поле для хранения текста произвольной длины

2. Специфичные атрибуты разных видов контента существенно различаются.
3. У всех видов контента присутствует атрибут "счетчик просмотров" (counter).
4. У всех видов контента и страниц есть атрибут "заголовок" (title).
5. Со страницей связан любой вид контента в любом количестве. Семантика такая: "на
страницу можно выложить любой вид контента в любом количестве". Например: на странице может
быть 5 видео, 3 аудио и 7 текстов в любом порядке и вперемешку.
	- Учтено, что в будущем виды контента могут добавляться и функционал должен легко
	расширяться

## Функциональные спецификации

1. Сделано API для получения списка всех страниц.
	- Поддерживается пагинация (постраничная выдача результатов)
	- В ответе содержится URL на API с детальной информацией о странице (пункт №2)

2. Сделано API для получения детальной информации о странице
	- Помимо атрибутов страницы в ответе содержится все привязанные к странице
	объекты контента в виде вложенной структуры - упорядоченного списка привязанных к
	странице объектов контента со всеми атрибутами, включая специфичные.

3. При обращении к API с деталями о странице счетчик просмотров кождого объекта контента,
привязанногок странице увеличивается на единицу.
	- Нагрузка на данное API предполагается существенная, позтому непосредственно изменение данных в БД было реализовано в фоновой задаче.
	- Увеличение счетчика должно происходить строго атомарно. То всть, если две задачи параллельно обновляют счетчик одного объекта, то на выходе всегда
должно получается "+2".

4. Заведение страници привязка к ним контента выполняется через админку.
	- Поддерживается поиск по заголовку (title) страниц и контента (по частичному совпадению от начала)
	- Реализована привязка и управление контентом на странице в виде inline-блоков в разделе управления страницей (Page) в админке.
	- Реализована возможность задавать порядок выдачи в API объектов, привязанных к странице.
 ## Установка
 Скачиваем проект и переходим в каталог
 
 ```
 git clone https://github.com/Zhichi57/django_pages_api.git
 cd django_pages_api  
 ```
Запускаем сборку с помошью docker-compose
```
docker-compose up -d --build
```
Выполняем миграции и создаем суперпользователя с данными из файла `.env`
```
docker-compose exec web python manage.py migrate --noinput
docker-compose exec web python manage.py createsuperuser --noinput
```
Перезапускаем сервер
```
docker-compose restart web
```
Список страниц будет доступен по адресу `http://127.0.0.1:8000/pages/`  
Админка будет доступна по адресу `http://127.0.0.1:8000/admin/`
